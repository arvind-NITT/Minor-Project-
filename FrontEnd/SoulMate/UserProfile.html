<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Profile</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="Profile.css" />

  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap"
    rel="stylesheet">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Lakki+Reddy&display=swap');
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- <link rel="stylesheet" href="mitra.css"/> -->
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />

</head>

<body>
  <div>
    <section>
      <header>
        <div class="pannel2">
          <div class="pannel-first2">
            <i class="fa-solid fa-magnifying-glass"></i>
            <div class="border2">ABOUT</div>
            <div class="border2">FAQ</div>
            <div class="border2">CONTACT</div>
          </div>
          <div class="pannel-second2">
            <div class="social-work2 border2"><i class="fa-solid fa-phone"></i>
              <p>+0153125312</p>
            </div>
            <div class="social-work2 border2"><i class="fa-regular fa-envelope"></i>
              <p>HELP@company.com</p>
            </div>
            <div class="social-icons2">
              <div class="sicons" style="border-left: 0px;">
          <img src="./images/facebook.png" alt=""></div>
        <div class="sicons"><img  src="./images/twitter.png" alt=""></div> 
         <div  class="sicons"> <img  src="./images/whatsapp.png" alt=""></div>
      </div>
          </div>
        </div>
      </header>
    </section>
    <div class="homtop2">
      <div class="container2">
        <div class="logo2">
          <img id="logo2" src="./images/logo-b.png" alt="" srcset="">
        </div>
        <div class="Menu2">
          <span class="smenu2">EXPLORE</span>
          <span class="smenu2">ALL PAGES</span>
          <span class="smenu2">TOP PAGES</span>
          <span class="smenu2">PLANES</span>
          <span class="smenu2">REGISTER</span>
          <span class="smenu2">DASHBOARD</span>
        </div>
        <div class="team2">
          <img src="images/2.jpg" alt="" loading="lazy">
          <div class="add2">
            <b class="Advisor2">Advisor</b><br>
            <h4 style="color:#66451c;">Arvind</h4>
          </div>
        </div>
      </div>
    </div>

    <!-- second part will be started -->
    <div class="maindiv">
      <div class="profile">
        <img class="profile-img1" src="./images/12.jpg" alt="" srcset="">
        <div>
          <ul>
            <li> <i class="fa-solid fa-gauge"> </i> Dashboard</li>
            <li><i class="fa-solid fa-person"></i>Profile</li>
            <li><i class="fa-solid fa-handshake"></i>Interested</li>
            <li><i class="fa-regular fa-comment-dots"></i>Chat list</li>
            <li><i class="fa-solid fa-money-bills"></i>Plan</li>
            <li><i class="fa-solid fa-gear"></i>Setting</li>
            <li><i class="fa-solid fa-right-from-bracket"></i>Layout</li>
          </ul>
        </div>
      </div>
      <div class="new-profile-match">
        <div class="font">New Profiles Matches
        </div>
        <div class="allgrid">
          <div class="grid-container">
            <div class="grid-item" style="background-image: url(./images/3.jpg);">
              <div class="text-content">
                <h5>Julie ann</h5>
                <h6>new york 22 year old</h6>
              </div>
            </div>
            <div class="grid-item" style="background-image: url(./images/4.jpg);">
              <div class="text-content">
                <h5>Julie ann</h5>
                <h6>new york 22 year old</h6>
              </div>
            </div>
            <div class="grid-item" style="background-image: url(./images/2.jpg);">
              <div class="text-content">
                <h5>Julie ann</h5>
                <h6>new york 22 year old</h6>
              </div>
            </div>
            <div class="grid-item" style="background-image: url(./images/5.jpeg);">
              <div class="text-content">
                <h5>Julie ann</h5>
                <h6>new york 22 year old</h6>
              </div>
            </div>
            <div class="grid-item" style="background-image: url(./images/6.jpg);">
              <div class="text-content">
                <h5>Julie ann</h5>
                <h6>new york 22 year old</h6>
              </div>
            </div>
          </div>
        </div>



        <div class="allgridbottem">
          <div class="grid-element0">
            <div style="width: 31%;">

              <h2>Profiles status</h2>
            </div>
            <div style="width: 30%;">

              <h2>Plan details</h2>
            </div>
            <div style="width: 30%">
              <h2>Recent chat list</h2>

            </div>
          </div>
          <div class="grid-element1">
            <!-- first image bottom is start -->

            <div class="grid-box">
              <div class="boxcontent">Profile Completion
              </div>
              <div class="ii">
                <img src="./images/90.png" alt="" srcset="">
              </div>
              <div class="boxcontent1">
                <div class="boxcontent2">
                  <div><i class="fa-brands fa-gratipay icon" style="color: #e6000b;"></i> 12 likes</div>
                  <div><i class="fa-solid fa-eye icon" style="color: #63E6BE;"></i>12 views</div>
                </div>
                <div class="boxcontent3">
                  <div><i class="fa-solid fa-handshake icon" style="color: #FFD43B;"></i> 12 interests</div>
                  <div><i class="fa-solid fa-hand-point-up icon" style="color: #083c63;"></i>12 clicks</div>
                </div>
              </div>
            </div>

            <!-- first image bottom is complite -->
            <!-- second image bottom is started -->


            <div class="grid-box" id="standard_plan">
              <div class="boxcontent" >Standard plan

              </div>
              <div class="iii"><img src="./images/91.png" alt="" srcset="">
              </div>
              <div class="plans">
                <div class="plan1">Plan name: <strong>Standard</strong> </div>
                <div class="plan2">Validity:<strong> 6 Months</strong>
                </div>
                <div class="plan3">Valid till :<strong>24 June 2024</strong>
                </div>

              </div>
              <botton class="btn1">
                <div class="UPGRADENOW
          ">UPGRADE</div>
              </botton>

            </div>
            <!-- second image bottom is complite -->
            <!-- third image bottom is started -->


            <div class="grid-box">

              <div class="grid-row">
                <div class="Chat_img">
                  <img src="./images/11.jpg" alt="">
                </div>
                <div class="chat-box">
                  <h2 class="chat_name">Julia Ann
                  </h2>
                  <h4 class="chat_address">Illunois, United States
                  </h4>
                </div>
              </div>

              <div class="grid-row">
                <div class="Chat_img">
                  <img src="./images/71.jpg" alt="">
                </div>
                <div class="chat-box">
                  <h2 class="chat_name">Julia Ann
                  </h2>
                  <h4 class="chat_address">Illunois, United States
                  </h4>
                </div>
              </div>
              <div class="grid-row">
                <div class="Chat_img">
                  <img src="./images/72.jpg" alt="">
                </div>
                <div class="chat-box">
                  <h2 class="chat_name">Julia Ann
                  </h2>
                  <h4 class="chat_address">Illunois, United States
                  </h4>
                </div>
              </div>
              <div class="grid-row">
                <div class="Chat_img">
                  <img src="./images/73.jpg" alt="">
                </div>
                <div class="chat-box">
                  <h2 class="chat_name">Julia Ann
                  </h2>
                  <h4 class="chat_address">Illunois, United States
                  </h4>
                </div>
              </div>

            </div>

          </div>

        </div>


      </div>

    </div>
    <div class="mycontainerupper">
      <div class="Interestrequest">Interest request

      </div>
      <div class="mycontainer">
        <div class="mycontainer1">
          <div class="mycontainer2">
            <div class="mycontainer3" id="tab-new-requests">New requests</div>
            <div class="mycontainer3" id="tab-accept-request">Accept request</div>
            <div class="mycontainer3" id="tab-deny-request">Deny request</div>
            <div class="mycontainer4">

            </div>
          </div>

          <div class=" New-requests" id="content-new-requests">
        
          </div>
          <div class="Accept-request" id="content-accept-request" style="display:none;">
          
          </div>
          <div class=" Denay-request" id="content-deny-request" style="display:none;">
        
          </div>
        </div>
      </div>

    </div>
    <footer class="footer-custom">
      <div class="foot-panel1-custom">
        Free support: +92 (8800) 68 - 8960 | Email: info@example.com
      </div>

      <div class="foot-panel2-custom">
        <div class="sfoot-panel2-custom">
          <div class="content-section-custom">
            <h4>GET IN TOUCH</h4>
            <a class="custom-link">Address: 3812 Lena Lane City Jackson Mississippi</a>
            <a class="custom-link">Phone: +92 (8800) 68 - 8960</a>
            <a class="custom-link">Email: info@example.com</a>
          </div>
          <div class="content-section-custom">
            <h4>HELP & SUPPORT</h4>
            <ul>
              <a class="custom-link">About company</a>
              <a class="custom-link">Feedback</a>
              <a class="custom-link">Testimonials</a>
              <a class="custom-link">Contact us</a>
              <a class="custom-link">FAQs</a>
            </ul>
          </div>
          <div class="content-section-custom">
            <h4 class="hello-custom">SOCIAL MEDIA</h4>
            <div class="sicons1-custom">
              <i class="fa-brands fa-linkedin iborder" style="color: #092fec;"></i>
              <i class="fa-brands fa-square-whatsapp iborder" style="color: #63E6BE;"></i>
              <i class="fa-brands fa-facebook iborder" style="color: #0830f7;"></i>
              <i class="fa-brands fa-youtube iborder" style="color: #f00a15;"></i>
            </div>
          </div>
        </div>
      </div>

      <div class="foot-panel3-custom">
        <div class="footerline-custom">
          company name Site - Trusted by over thousands of Boys & Girls for successful marriage.
        </div>
      </div>
      <div class="foot-panel4-custom">
        <div class="copy-right-custom">Copyright © 2023 Company.com All rights reserved.</div>
      </div>
    </footer>
    <!-- final touchup on that -->

    <!-- <script src="users.js"></script> -->
    <script src="https://kit.fontawesome.com/70e4c7df19.js" crossorigin="anonymous"></script>
    <script src="script.js"></script>
    <script src="https://kit.fontawesome.com/a76257bc34.js" crossorigin="anonymous"></script>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="UserProfileScript.js"></script>
    <script>
      $(document).ready(function () {
        const token = localStorage.getItem('token');
        fetch('http://localhost:5157/api/User/GetMyMatches', {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json',
            'Access-Control-Allow-Origin': "*",
            'Authorization': `Bearer ${token}`
          },

        })
          .then(response => {
            if (!response.ok) {
              // throw new Error('Network response was not ok');
              console.log(response.json());
              alert('Register failed: ' + data);
            }
            return response.json();
          })
          .then(data => {
            console.log('Response:', data);
            const approvedMatches = [];
            const pendingMatches = [];
            const RejectedMatches = [];

            // Iterate over each match and separate based on matchStatus
            data.forEach(match => {
              if (match.matchStatus == "Approved") {
                approvedMatches.push(match);
              } else if (match.matchStatus == "Pending") {
                pendingMatches.push(match);
              }
              else {
                RejectedMatches.push(match);
              }
            });
            console.log(approvedMatches);
            const approvedRequestsDiv = document.querySelector('.Accept-request');

            approvedMatches.forEach(match => {
              const matchDiv = document.createElement('div');
              matchDiv.classList.add('row');
              const matchDate = new Date(match.matchDate).toLocaleDateString();
              matchDiv.innerHTML = `
              <div class="ProfilePhoto">
                <img src="./Images/14.jpg" alt="" srcset="">
              </div>
              <div class="BioData">
                <strong style="margin-left:50px;">${match.matchedFirstName} ${match.matchedLastName}</strong>
              <ul>
                  <li><span>Income :</span> <strong>${match.matchedIncome || 'Unknown'}</strong></li>
                  <li><span>Religion :</span> <strong>${match.matchedReligion || 'Unknown'}</strong></li>
                  <li><span>Height :</span> <strong>${(match.matchedHeight / 30.48).toFixed(1)} ft</strong></li>
                  <li><span>Education :</span> <strong>${match.matchedEducation || 'Unknown'}</strong></li>
                </ul>
                <ul>
                  <li>Request on: ${matchDate}</li>
                </ul>
                <div class="view-profile-btn"> View Full Profile</div>
              </div>
              <div class="Buttons">
                <div class="denay" data-match-id=${match.matchedUserID}> Deny</div>
              </div>
            `;

            approvedRequestsDiv.appendChild(matchDiv);
            });
      approvedRequestsDiv.addEventListener('click', function(event) {
          if (event.target.classList.contains('denay')) {
            const matchId = event.target.getAttribute('data-match-id');
            console.log(matchId);
            fetch('http://localhost:5157/api/Match/UpdateMatchStatus', {
              method: 'PUT',
              headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json',
            'Access-Control-Allow-Origin': "*",
            'Authorization': `Bearer ${token}`
          },
              body: JSON.stringify({ "UserID2": matchId, "MatchStatus": 'Rejected' })
            })
            .then(response => response.json())
            .then(data => {
              // Handle the response data
              console.log('Match status updated:', data);
              location.reload();
            })
            .catch(error => {
              console.error('Error updating match status:', error);
            });
          }
});
           
            // localStorage.setItem('token',data.token)
            const RejectedRequestsDiv = document.querySelector('.Denay-request');

            RejectedMatches.forEach(match => {
              const matchDiv = document.createElement('div');
              matchDiv.classList.add('row');
              const matchDate = new Date(match.matchDate).toLocaleDateString();
              matchDiv.innerHTML = `
              <div class="ProfilePhoto">
                <img src="./Images/14.jpg" alt="" srcset="">
              </div>
              <div class="BioData">
                <strong style="margin-left:50px;">${match.matchedFirstName} ${match.matchedLastName}</strong>
                <ul>
                  <li><span>Income :</span> <strong>${match.matchedIncome || 'Unknown'}</strong></li>
                  <li><span>Religion :</span> <strong>${match.matchedReligion || 'Unknown'}</strong></li>
                  <li><span>Height :</span> <strong>${(match.matchedHeight / 30.48).toFixed(1)} ft</strong></li>
                  <li><span>Education :</span> <strong>${match.matchedEducation || 'Unknown'}</strong></li>
                </ul>
                <ul>
                  <li>Request on: ${matchDate}</li>
                </ul>
                <div class="view-profile-btn"> View Full Profile</div>
              </div>
              <div class="Buttons">
               <div class="accept-btn" data-match-id=${match.matchedUserID}> Accept</div>
               
              </div>
            `;

            RejectedRequestsDiv.appendChild(matchDiv);
            });
            RejectedRequestsDiv.addEventListener('click', function(event) {
          if (event.target.classList.contains('accept-btn')) {
            const matchId = event.target.getAttribute('data-match-id');
            console.log(matchId);
            fetch('http://localhost:5157/api/Match/UpdateMatchStatus', {
              method: 'PUT',
              headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json',
            'Access-Control-Allow-Origin': "*",
            'Authorization': `Bearer ${token}`
          },
              body: JSON.stringify({ "UserID2": matchId, "MatchStatus": 'Approved' })
            })
            .then(response => response.json())
            .then(data => {
              // Handle the response data
              console.log('Match status updated:', data);
              location.reload();
            })
            .catch(error => {
              console.error('Error updating match status:', error);
            });
          }
});
       
            // localStorage.setItem('token',data.token)
            const newRequestsDiv = document.querySelector('.New-requests');

            pendingMatches.forEach(match => {
              const matchDiv = document.createElement('div');
              matchDiv.classList.add('row');
              const matchDate = new Date(match.matchDate).toLocaleDateString();
              matchDiv.innerHTML = `
              <div class="ProfilePhoto">
                <img src="./Images/14.jpg" alt="" srcset="">
              </div>
              <div class="BioData">
                <strong style="margin-left:50px;">${match.matchedFirstName} ${match.matchedLastName}</strong>
                <ul>
                  <li><span>Income :</span> <strong>${match.matchedIncome || 'Unknown'}</strong></li>
                  <li><span>Religion :</span> <strong>${match.matchedReligion || 'Unknown'}</strong></li>
                  <li><span>Height :</span> <strong>${(match.matchedHeight / 30.48).toFixed(1)} ft</strong></li>
                  <li><span>Education :</span> <strong>${match.matchedEducation || 'Unknown'}</strong></li>
                </ul>
                <ul>
                  <li>Request on: ${matchDate}</li>
                </ul>
                <div class="view-profile-btn"> View Full Profile</div>
              </div>
              <div class="Buttons">
                <div class="accept-btn" data-match-id=${match.matchedUserID}> Accept</div>
                <div class="denay" data-match-id=${match.matchedUserID}> Deny</div>
              </div>
            `;
              
              newRequestsDiv.appendChild(matchDiv);
            });
            newRequestsDiv.addEventListener('click', function(event) {
          if (event.target.classList.contains('accept-btn')) {
            const matchId = event.target.getAttribute('data-match-id');
            console.log(matchId);
            fetch('http://localhost:5157/api/Match/UpdateMatchStatus', {
              method: 'PUT',
              headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json',
            'Access-Control-Allow-Origin': "*",
            'Authorization': `Bearer ${token}`
          },
              body: JSON.stringify({ "UserID2": matchId, "MatchStatus": 'Approved' })
            })
            .then(response => response.json())
            .then(data => {
              // Handle the response data
              console.log('Match status updated:', data);
              location.reload();
            })
            .catch(error => {
              console.error('Error updating match status:', error);
            });
          }
});
            newRequestsDiv.addEventListener('click', function(event) {
          if (event.target.classList.contains('denay')) {
            const matchId = event.target.getAttribute('data-match-id');
            console.log(matchId);
            fetch('http://localhost:5157/api/Match/UpdateMatchStatus', {
              method: 'PUT',
              headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json',
            'Access-Control-Allow-Origin': "*",
            'Authorization': `Bearer ${token}`
          },
              body: JSON.stringify({ "UserID2": matchId, "MatchStatus": 'Rejected' })
            })
            .then(response => response.json())
            .then(data => {
              // Handle the response data
              console.log('Match status updated:', data);
              location.reload();
            })
            .catch(error => {
              console.error('Error updating match status:', error);
            });
          }
});
            // localStorage.setItem('token',data.token)
            // window.location.href = './Login.html';
          })
          .catch(error => {
            console.error('Error:', error);
            alert('An error occurred: ' + error);
          });
      });

      document.getElementById('tab-new-requests').addEventListener('click', function () {
        document.getElementById('content-new-requests').style.display = 'block';
        document.getElementById('content-accept-request').style.display = 'none';
        document.getElementById('content-deny-request').style.display = 'none';
      });

      document.getElementById('tab-accept-request').addEventListener('click', function () {
        document.getElementById('content-new-requests').style.display = 'none';
        document.getElementById('content-accept-request').style.display = 'block';
        document.getElementById('content-deny-request').style.display = 'none';
      });

      document.getElementById('tab-deny-request').addEventListener('click', function () {
        document.getElementById('content-new-requests').style.display = 'none';
        document.getElementById('content-accept-request').style.display = 'none';
        document.getElementById('content-deny-request').style.display = 'block';
      });

    </script>

</body>

</html>